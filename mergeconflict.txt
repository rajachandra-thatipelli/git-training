modification from master 2
